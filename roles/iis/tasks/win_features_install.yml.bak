---
- name: Install File Server on Windows.
  win_feature:
    name: File-Services
    state: present

# Do not add include_include_sub_features: true and include_management_tools: true
# Unless you want everything to be included.
- name: Install IIS Web Server on Windows.
  win_feature:
    name: 
    - Web-Server
    - Web-Http-Redirect
    - Web-FTP-Server
    state: present
    include_management_tools: true

- name: Addon IIS Web Server Application Development .NET and ASP.NET.
  win_feature:
    name: Web-App-Dev
    state: present

- name: Addon IIS Web Server Applicatio Development .NET Windows features
  win_feature:
    name: Web-Asp-Net45
    state: present

- name: Addon IIS Web Server FTP Server FTP Extensibility
  win_feature:
    name:
    - Web-Ftp-Service
    - Web-Ftp-Ext
    state: present

- name: Install Windows BitLocker Drive Encryption.
  win_feature:
    name: BitLocker
    state: present

- name: Install Windows Feature Group Policy Management.
  win_feature:
    name: GPMC
    state: present

- name: Install Windows Feature Remote Server Administration Tools AD-DS-LDS-Tools.
  win_feature:
    name: RSAT-AD-Tools
    state: present

- name: Install Windows Feature Remote Server Administration Tools DNS-Server.
  win_feature:
    name: RSAT-DNS-Server
    state: present

- name: Install Windows Feature Windows Server Activation Service Process-Model.
  win_feature:
    name: WAS-Process-Model
    state: present

- name: Install Windows Feature Windows Server Activation Service Configuration APIS.
  win_feature:
    name: WAS-Config-APIs
    state: present

- name: Install Windows Feature Windows Search Service.
  win_feature:
    name: Search-Service
    state: present
  register: win_feature
  
- name: Restart Windows.
  win_reboot:
    reboot_timeout: 3600
  when: win_feature.reboot_required
